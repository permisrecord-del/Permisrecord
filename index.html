<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Permis Record | Votre auto-√©cole en ligne</title>
    <!-- Chargement de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configuration de la police Inter -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000000; /* Fond noir */
            color: #E2E8F0; /* Texte gris clair par d√©faut */
        }
        .gold-text {
            color: #FFD700; /* Couleur Or */
        }
        .gold-border {
            border-color: #FFD700; /* Couleur Or */
        }
        .gold-bg {
            background-color: #FFD700; /* Couleur Or */
        }
        /* Assure que le body prend toute la hauteur et que le footer reste en bas */
        .min-h-screen {
            display: flex;
            flex-direction: column;
        }
        main {
            flex-grow: 1;
        }
    </style>
</head>
<body class="min-h-screen">

    <!-- En-t√™te (Header) -->
    <header class="bg-gray-900 shadow-xl sticky top-0 z-10">
        <div class="max-w-4xl mx-auto px-4 py-4 flex flex-col sm:flex-row justify-between items-center">
            
            <div class="mb-2 sm:mb-0 text-center sm:text-left">
                <h1 class="text-3xl font-extrabold gold-text">
                    PERMIS RECORD
                </h1>
                <p class="text-sm text-gray-400">La route vers votre libert√©</p>
            </div>
            
            <!-- Num√©ro de t√©l√©phone -->
            <a href="tel:+33767739780" class="flex items-center text-lg font-bold text-white hover:gold-text transition duration-200 mt-2 sm:mt-0 p-2 rounded-lg bg-gray-800 border gold-border border-opacity-30">
                <!-- Ic√¥ne de t√©l√©phone üìû -->
                <span class="gold-text mr-2 text-xl">&#128222;</span>
                <span class="tracking-wider">07 67 73 97 80</span>
            </a>
            
        </div>

        <!-- Navigation principale par onglets -->
        <nav class="bg-gray-800 border-t border-b gold-border">
            <div class="max-w-4xl mx-auto flex justify-around text-center">
                <button onclick="showSection('accueil-et-reservation')" class="tab-button w-1/6 py-3 px-1 text-xs sm:text-sm font-semibold transition duration-300 hover:bg-gray-700" data-target="accueil-et-reservation">
                    Accueil
                </button>
                <button onclick="showSection('inscription')" class="tab-button w-1/6 py-3 px-1 text-xs sm:text-sm font-semibold transition duration-300 hover:bg-gray-700" data-target="inscription">
                    Inscription
                </button>
                <button onclick="showSection('tarifs')" class="tab-button w-1/6 py-3 px-1 text-xs sm:text-sm font-semibold transition duration-300 hover:bg-gray-700" data-target="tarifs">
                    Tarifs
                </button>
                <button onclick="showSection('examen')" class="tab-button w-1/6 py-3 px-1 text-xs sm:text-sm font-semibold transition duration-300 hover:bg-gray-700" data-target="examen">
                    Examen
                </button>
                <button onclick="showSection('code')" class="tab-button w-1/6 py-3 px-1 text-xs sm:text-sm font-semibold transition duration-300 hover:bg-gray-700" data-target="code">
                    Code
                </button>
                <button onclick="showSection('legales')" class="tab-button w-1/6 py-3 px-1 text-xs sm:text-sm font-semibold transition duration-300 hover:bg-gray-700" data-target="legales">
                    Infos L√©gales
                </button>
            </div>
        </nav>
    </header>

    <!-- Contenu principal -->
    <main class="max-w-4xl mx-auto p-4 sm:p-8">

        <!-- Message de confirmation/erreur (Modal Mockup) -->
        <div id="message-box" class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center z-50 p-4">
            <div class="bg-gray-800 p-6 rounded-xl shadow-2xl w-full max-w-sm border-t-4 gold-border">
                <h3 id="message-title" class="text-xl font-bold gold-text mb-3">Confirmation</h3>
                <p id="message-content" class="text-gray-300 mb-5">Votre demande a √©t√© enregistr√©e avec succ√®s.</p>
                <button onclick="hideMessage()" class="w-full py-2 px-4 rounded-lg gold-bg text-gray-900 font-bold hover:bg-yellow-400 transition duration-200">
                    Fermer
                </button>
            </div>
        </div>


        <!-- SECTION 1: Accueil et R√©servation d'heures de conduite -->
        <section id="accueil-et-reservation" class="content-section">

            <!-- Bloc Accueil/H√©ros -->
            <div class="p-6 sm:p-8 mb-8 bg-gray-900 rounded-xl shadow-2xl border gold-border border-opacity-50 flex flex-col items-center text-center">
                
                <h2 class="text-3xl sm:text-4xl font-extrabold text-white mb-2">
                    Bienvenue sur Permis Record !
                </h2>
                <p class="text-xl gold-text font-semibold mb-4">
                    "Ma Libert√© √† Prix Record."
                </p>
                <p class="text-gray-400 max-w-lg">
                    Commencez d√®s aujourd'hui votre formation en ligne. R√©servez vos le√ßons de conduite ou soumettez votre dossier d'inscription ci-dessous.
                </p>
                <button onclick="showSection('inscription')" class="mt-6 py-3 px-8 rounded-lg gold-bg text-gray-900 font-bold text-lg transition duration-200 shadow-xl hover:shadow-yellow-500/70">
                    Je m'inscris maintenant
                </button>
            </div>
            <!-- Fin Bloc Accueil/H√©ros -->


            <div class="p-6 bg-gray-900 rounded-xl shadow-lg border gold-border border-opacity-30">
                <h2 class="text-2xl font-bold gold-text mb-6 border-b pb-2 border-gray-700">R√©servez et Payez vos Heures de Conduite</h2>
                
                <!-- Le formulaire de r√©servation de le√ßons -->
                <form id="reservation-form" onsubmit="handleFormSubmission(event, 'conduite')" class="space-y-4 mb-8">
                    <!-- Email de l'√©l√®ve (Ajout√© pour identifier le r√©servateur) -->
                    <div>
                        <label for="lesson-email" class="block text-sm font-medium text-gray-400">Votre Email (obligatoire)</label>
                        <input type="email" id="lesson-email" required placeholder="nom.prenom@example.com" class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white">
                    </div>

                    <!-- Type de le√ßon avec √©v√©nement onchange pour la mise √† jour du prix -->
                    <div>
                        <label for="lesson-type" class="block text-sm font-medium text-gray-400">Type de Le√ßon</label>
                        <select id="lesson-type" onchange="updatePriceDisplay()" required class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white">
                            <option value="">S√©lectionnez un type</option>
                            <!-- Les valeurs correspondent aux cl√©s dans LESSON_PRICES en JS -->
                            <option value="perfectionnement">Perfectionnement (1h) - 50 ‚Ç¨</option>
                            <option value="initiale">Le√ßon initiale (2h) - 100 ‚Ç¨</option>
                            <option value="conduite_accompagnee">Conduite Accompagn√©e (2h) - 100 ‚Ç¨</option>
                        </select>
                    </div>

                    <!-- AFFICHAGE DYNAMIQUE DU PRIX -->
                    <div id="lesson-price-display" class="p-3 bg-gray-800 rounded-lg text-center font-bold text-xl transition-all duration-300">
                        <!-- Le prix sera affich√© ici -->
                        S√©lectionnez une le√ßon pour voir le prix.
                    </div>

                    <!-- Date souhait√©e -->
                    <div>
                        <label for="lesson-date" class="block text-sm font-medium text-gray-400">Date Souhait√©e</label>
                        <input type="date" id="lesson-date" required class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white">
                    </div>

                    <!-- Heure souhait√©e -->
                    <div>
                        <label for="lesson-time" class="block text-sm font-medium text-gray-400">Heure de D√©but</label>
                        <input type="time" id="lesson-time" required min="08:00" max="18:00" class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white">
                    </div>

                    <button type="submit" id="reserve-button" disabled class="w-full py-3 px-4 mt-6 rounded-lg bg-gray-600 text-gray-300 font-bold text-lg cursor-not-allowed transition duration-200">
                        Payer et R√©server la Le√ßon (via PayPal)
                    </button>
                    <p class="text-center text-sm text-gray-500">
                        Le paiement s√©curis√© est effectu√© via la plateforme PayPal.
                    </p>
                </form>
            </div>
        </section>

        <!-- SECTION 2: Inscription de l'√©l√®ve (Reste inchang√©e) -->
        <section id="inscription" class="content-section hidden">
            <div class="p-6 bg-gray-900 rounded-xl shadow-lg border gold-border border-opacity-30">
                <h2 class="text-2xl font-bold gold-text mb-6 border-b pb-2 border-gray-700">Inscription √† l'Auto-√âcole</h2>
                <p class="text-gray-400 mb-6">Veuillez remplir ce formulaire pour cr√©er votre dossier √©l√®ve et commencer votre formation.</p>

                <form onsubmit="handleFormSubmission(event, 'inscription')" class="space-y-4">
                    <!-- Section Identit√© -->
                    <h3 class="text-lg font-semibold gold-text pt-2">Informations Personnelles</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label for="reg-lastname" class="block text-sm font-medium text-gray-400">Nom</label>
                            <input type="text" id="reg-lastname" required class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white">
                        </div>
                        <div>
                            <label for="reg-firstname" class="block text-sm font-medium text-gray-400">Pr√©nom</label>
                            <input type="text" id="reg-firstname" required class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white">
                        </div>
                    </div>
                    <div>
                        <label for="reg-dob" class="block text-sm font-medium text-gray-400">Date de Naissance</label>
                        <input type="date" id="reg-dob" required class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white">
                    </div>

                    <!-- Section Contact -->
                    <h3 class="text-lg font-semibold gold-text pt-4">Coordonn√©es</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label for="reg-email" class="block text-sm font-medium text-gray-400">Email</label>
                            <input type="email" id="reg-email" required class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white">
                        </div>
                        <div>
                            <label for="reg-phone" class="block text-sm font-medium text-gray-400">T√©l√©phone</label>
                            <input type="tel" id="reg-phone" required class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white">
                        </div>
                    </div>
                    
                    <!-- Section Formation -->
                    <h3 class="text-lg font-semibold gold-text pt-4">Choix de la Formation</h3>
                    <div>
                        <label for="reg-permit" class="block text-sm font-medium text-gray-400">Permis Souhait√©</label>
                        <select id="reg-permit" required class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white">
                            <option value="">S√©lectionnez un permis</option>
                            <option value="B">Permis B (Voiture)</option>
                            <option value="A2">Permis A2 (Moto)</option>
                            <option value="AAC">Conduite Accompagn√©e (AAC)</option>
                            <option value="Code">Uniquement Code de la Route</option>
                        </select>
                    </div>
                    
                    <!-- Consentement -->
                    <div class="flex items-start pt-4">
                        <input id="reg-cgv" type="checkbox" required class="h-4 w-4 rounded gold-bg border-gray-300 text-yellow-600 focus:ring-yellow-500">
                        <label for="reg-cgv" class="ml-3 text-sm text-gray-400">
                            J'accepte les <a href="#" onclick="showSection('legales'); return false;" class="gold-text hover:underline">Conditions G√©n√©rales de Vente</a> et la Politique de Confidentialit√©.
                        </label>
                    </div>

                    <button type="submit" class="w-full py-3 px-4 mt-6 rounded-lg gold-bg text-gray-900 font-bold text-lg transition duration-200 shadow-md hover:shadow-yellow-500/50">
                        Soumettre mon Dossier d'Inscription
                    </button>
                </form>
            </div>
        </section>

        <!-- SECTION 3: Tarifs et Forfaits (Reste inchang√©e) -->
        <section id="tarifs" class="content-section hidden">
            <div class="p-6 bg-gray-900 rounded-xl shadow-lg border gold-border border-opacity-30">
                <h2 class="text-2xl font-bold gold-text mb-6 border-b pb-2 border-gray-700">Nos Tarifs et Forfaits Comp√©titifs</h2>
                <p class="text-gray-400 mb-8">Choisissez la formule qui convient le mieux √† vos objectifs et √† votre budget. Tous nos forfaits incluent les frais de dossier et l'acc√®s √† la plateforme Code en ligne.</p>

                <!-- Grille des Forfaits -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

                    <!-- Forfait 1: Code Seul -->
                    <div class="bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700 hover:border-yellow-500 transition duration-300">
                        <h3 class="text-xl font-bold gold-text mb-2">Code de la Route (ETG)</h3>
                        <p class="text-3xl font-extrabold gold-text mb-4">199 ‚Ç¨</p>
                        <ul class="text-gray-300 space-y-2 text-sm">
                            <li class="flex items-center">
                                <span class="gold-text mr-2">‚úì</span> Acc√®s illimit√© plateforme en ligne (6 mois)
                            </li>
                            <li class="flex items-center">
                                <span class="gold-text mr-2">‚úì</span> Suivi de progression personnalis√©
                            </li>
                            <li class="flex items-center">
                                <span class="gold-text mr-2">‚úì</span> 1 Pr√©sentation √† l'examen th√©orique
                            </li>
                            <li class="flex items-center text-gray-500">
                                <span class="text-gray-600 mr-2">‚úó</span> Heures de conduite
                            </li>
                        </ul>
                        <button onclick="showMessage('Achat Code', 'Vous serez redirig√© vers le paiement pour le Forfait Code. Merci !')" class="w-full mt-6 py-3 rounded-lg gold-bg text-gray-900 font-bold hover:bg-yellow-400 transition duration-200">
                            S'inscrire au Code
                        </button>
                    </div>

                    <!-- Forfait 2: Permis B (20h) -->
                    <div class="bg-gray-800 p-6 rounded-xl shadow-2xl border-4 gold-border ring-2 ring-yellow-500">
                        <h3 class="text-xl font-bold gold-text mb-2">Permis B Standard (20h)</h3>
                        <p class="text-3xl font-extrabold gold-text mb-4">1199 ‚Ç¨</p>
                        <ul class="text-gray-300 space-y-2 text-sm">
                            <li class="flex items-center">
                                <span class="gold-text mr-2">‚úì</span> Forfait Code Inclus (Acc√®s 1 an)
                            </li>
                            <li class="flex items-center">
                                <span class="gold-text mr-2">‚úì</span> **20 Heures de Conduite** obligatoires
                            </li>
                            <li class="flex items-center">
                                <span class="gold-text mr-2">‚úì</span> √âvaluation de d√©part
                            </li>
                            <li class="flex items-center">
                                <span class="gold-text mr-2">‚úì</span> 1 Pr√©sentation √† l'examen pratique
                            </li>
                        </ul>
                        <button onclick="showSection('inscription')" class="w-full mt-6 py-3 rounded-lg gold-bg text-gray-900 font-bold hover:bg-yellow-400 transition duration-200">
                            Je m'inscris au Permis B
                        </button>
                    </div>

                    <!-- Forfait 3: Conduite Accompagn√©e -->
                    <div class="bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700 hover:border-yellow-500 transition duration-300">
                        <h3 class="text-xl font-bold gold-text mb-2">Conduite Accompagn√©e (AAC)</h3>
                        <p class="text-3xl font-extrabold gold-text mb-4">1499 ‚Ç¨</p>
                        <ul class="text-gray-300 space-y-2 text-sm">
                            <li class="flex items-center">
                                <span class="gold-text mr-2">‚úì</span> Forfait Code Inclus (Acc√®s 1 an)
                            </li>
                            <li class="flex items-center">
                                <span class="gold-text mr-2">‚úì</span> **25 Heures de Conduite** initiales
                            </li>
                            <li class="flex items-center">
                                <span class="gold-text mr-2">‚úì</span> Rendez-vous p√©dagogiques obligatoires
                            </li>
                            <li class="flex items-center">
                                <span class="gold-text mr-2">‚úì</span> 1 Pr√©sentation √† l'examen pratique
                            </li>
                        </ul>
                        <button onclick="showSection('inscription')" class="w-full mt-6 py-3 rounded-lg gold-bg text-gray-900 font-bold hover:bg-yellow-400 transition duration-200">
                            Je m'inscris √† l'AAC
                        </button>
                    </div>
                </div>
                
                <!-- Tarif Unitaire -->
                <div class="mt-10 p-4 bg-gray-900 border-t border-b border-gray-700 rounded-lg">
                    <p class="text-lg font-semibold gold-text">Tarif de l'Heure de Conduite Unitaire :</p>
                    <p class="text-xl font-extrabold text-gray-300 mt-1">50 ‚Ç¨ / heure</p>
                    <p class="text-sm text-gray-500 mt-2">Ce tarif s'applique apr√®s l'√©puisement des heures incluses dans un forfait.</p>
                </div>

            </div>
        </section>


        <!-- SECTION 4: R√©servation de date d'examen (Reste inchang√©e) -->
        <section id="examen" class="content-section hidden">
            <div class="p-6 bg-gray-900 rounded-xl shadow-lg border gold-border border-opacity-30">
                <h2 class="text-2xl font-bold gold-text mb-6 border-b pb-2 border-gray-700">Inscription √† l'Examen Pratique</h2>

                <form onsubmit="handleFormSubmission(event, 'examen')" class="space-y-4">
                    <!-- Permis concern√© -->
                    <div>
                        <label for="exam-type" class="block text-sm font-medium text-gray-400">Permis Concern√©</label>
                        <select id="exam-type" required class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white">
                            <option value="">S√©lectionnez le type de permis</option>
                            <option value="B">Permis B (Voiture)</option>
                            <option value="A2">Permis A2 (Moto)</option>
                            <option value="BE">Permis BE (Remorque)</option>
                        </select>
                    </div>

                    <!-- 1√®re date souhait√©e -->
                    <div>
                        <label for="exam-date-1" class="block text-sm font-medium text-gray-400">1√®re Date Pr√©f√©r√©e</label>
                        <input type="date" id="exam-date-1" required class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white">
                    </div>

                    <!-- 2√®me date souhait√©e -->
                    <div>
                        <label for="exam-date-2" class="block text-sm font-medium text-gray-400">2√®me Date Pr√©f√©r√©e (Optionnel)</label>
                        <input type="date" id="exam-date-2" class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white">
                    </div>

                    <!-- Message -->
                    <div>
                        <label for="exam-message" class="block text-sm font-medium text-gray-400">Commentaires (ex: cr√©neau horaire pr√©f√©r√©)</label>
                        <textarea id="exam-message" rows="3" class="mt-1 block w-full p-3 rounded-lg bg-gray-700 border-gray-600 focus:ring-yellow-500 focus:border-yellow-500 text-white"></textarea>
                    </div>

                    <button type="submit" class="w-full py-3 px-4 mt-6 rounded-lg gold-bg text-gray-900 font-bold text-lg transition duration-200 shadow-md hover:shadow-yellow-500/50">
                        Soumettre ma Demande
                    </button>
                </form>
            </div>
        </section>

        <!-- SECTION 5: R√©vision du Code de la Route en Ligne (Reste inchang√©e) -->
        <section id="code" class="content-section hidden">
            <div class="p-6 bg-gray-900 rounded-xl shadow-lg border gold-border border-opacity-30">
                <h2 class="text-2xl font-bold gold-text mb-6 border-b pb-2 border-gray-700">R√©vision du Code de la Route en Ligne</h2>
                <p class="text-gray-400 mb-6">Pr√©parez-vous √† l'examen du Code de la Route avec nos s√©ries de tests th√©matiques.</p>

                <!-- Zone de progression (Mock-up) -->
                <div class="mb-8 p-4 bg-gray-800 rounded-lg">
                    <h3 class="text-xl font-semibold gold-text mb-2">Votre Progression</h3>
                    <div class="w-full bg-gray-700 rounded-full h-2.5 mb-4">
                        <div class="gold-bg h-2.5 rounded-full" style="width: 65%"></div>
                    </div>
                    <p class="text-sm text-gray-400">65% des th√®mes couverts. Bonne route !</p>
                </div>

                <!-- Grille des s√©ries de tests -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">

                    <!-- Carte de s√©rie de test -->
                    <div class="p-4 bg-gray-800 rounded-lg border border-gray-700 hover:border-yellow-500 transition duration-300">
                        <h4 class="text-lg font-bold gold-text">S√©rie Th√©matique 1: Signalisation</h4>
                        <p class="text-gray-400 text-sm mb-3">Panneaux de danger, d'interdiction et d'obligation.</p>
                        <button onclick="showMessage('Code Lanc√©', 'Vous avez d√©marr√© la S√©rie 1. Bon courage !')" class="w-full py-2 px-4 rounded-lg gold-bg text-gray-900 font-bold text-sm hover:bg-yellow-400 transition duration-200">
                            Commencer le Test (40 questions)
                        </button>
                    </div>

                    <div class="p-4 bg-gray-800 rounded-lg border border-gray-700 hover:border-yellow-500 transition duration-300">
                        <h4 class="text-lg font-bold gold-text">S√©rie Th√©matique 2: Priorit√©s et Intersections</h4>
                        <p class="text-gray-400 text-sm mb-3">R√®gles de priorit√©, carrefours et ronds-points.</p>
                        <button onclick="showMessage('Code Lanc√©', 'Vous avez d√©marr√© la S√©rie 2. Bonne chance !')" class="w-full py-2 px-4 rounded-lg gold-bg text-gray-900 font-bold text-sm hover:bg-yellow-400 transition duration-200">
                            Commencer le Test (40 questions)
                        </button>
                    </div>

                    <div class="p-4 bg-gray-800 rounded-lg border border-gray-700 hover:border-yellow-500 transition duration-300">
                        <h4 class="text-lg font-bold gold-text">S√©rie Th√©matique 3: Vitesse et Distances</h4>
                        <p class="text-gray-400 text-sm mb-3">Limitations de vitesse et distances de s√©curit√©.</p>
                        <button onclick="showMessage('Code Lanc√©', 'Vous avez d√©marr√© la S√©rie 3. Concentrez-vous !')" class="w-full py-2 px-4 rounded-lg gold-bg text-gray-900 font-bold text-sm hover:bg-yellow-500/50">
                            Commencer le Test (40 questions)
                        </button>
                    </div>

                    <div class="p-4 bg-gray-800 rounded-lg border border-gray-700 opacity-60">
                        <h4 class="text-lg font-bold gold-text">S√©rie Th√©matique 4: Secourisme</h4>
                        <p class="text-gray-400 text-sm mb-3">Th√®me √† venir !</p>
                        <button disabled class="w-full py-2 px-4 rounded-lg bg-gray-600 text-gray-400 font-bold text-sm cursor-not-allowed">
                            Indisponible
                        </button>
                    </div>

                </div>

            </div>
        </section>
        
        <!-- SECTION 6: Informations L√©gales (Reste inchang√©e) -->
        <section id="legales" class="content-section hidden">
            <div class="p-6 bg-gray-900 rounded-xl shadow-lg border gold-border border-opacity-30">
                <h2 class="text-2xl font-bold gold-text mb-6 border-b pb-2 border-gray-700">Informations L√©gales et Conditions G√©n√©rales</h2>

                <div class="space-y-8">
                    <!-- Mentions L√©gales (Mock-up) -->
                    <article>
                        <h3 class="text-xl font-semibold gold-text mb-3 border-b border-gray-700 pb-1">1. Mentions L√©gales</h3>
                        <p class="text-gray-400 mb-2">
                            Ce site est √©dit√© par **PERMIS RECORD SAS** (Soci√©t√© par Actions Simplifi√©e).
                        </p>
                        <ul class="list-disc list-inside ml-4 mt-2 text-gray-500 text-sm space-y-1">
                            <li>Raison Sociale : PERMIS RECORD SAS</li>
                            <li>N¬∞ SIRET : 123 456 789 00010 (Fictif)</li>
                            <li>Si√®ge Social : 10 Rue de la Libert√©, 75001 Paris, France</li>
                            <li>Directeur de la publication : M. Alex Dupond</li>
                            <li>H√©bergeur : Fictif Hosting S.A.</li>
                            <li>T√©l√©phone : <a href="tel:+33767739780" class="gold-text hover:underline">07 67 73 97 80</a></li>
                            <li>Contact (Email) : permisrecord@gmail.com</li>
                        </ul>
                    </article>

                    <!-- Conditions G√©n√©rales de Vente (Mock-up) -->
                    <article>
                        <h3 class="text-xl font-semibold gold-text mb-3 border-b border-gray-700 pb-1">2. Conditions G√©n√©rales de Vente (CGV)</h3>
                        <p class="text-gray-400 mb-2">
                            Toute r√©servation de service est soumise aux Conditions G√©n√©rales de Vente. Extraits cl√©s :
                        </p>
                        <ul class="list-disc list-inside ml-4 mt-2 text-gray-500 text-sm space-y-1">
                            <li>**Annulation des Le√ßons :** Toute annulation doit √™tre notifi√©e 48 heures √† l'avance, faute de quoi la le√ßon est due.</li>
                            <li>**Validit√© des Formations :** Les forfaits (Code ou Conduite) sont valables 12 mois √† compter de la date d'achat.</li>
                            <li>**Frais d'Examen :** La pr√©sentation √† l'examen pratique est conditionn√©e au niveau de l'√©l√®ve, d√©cid√© par l'√©quipe p√©dagogique.</li>
                        </ul>
                    </article>

                    <!-- Politique de Confidentialit√© (Mock-up) -->
                    <article>
                        <h3 class="text-xl font-semibold gold-text mb-3 border-b border-gray-700 pb-1">3. Politique de Confidentialit√©</h3>
                        <p class="text-gray-400">
                            Nous collectons vos donn√©es (nom, email, historique de r√©servation) uniquement pour la gestion de votre dossier et le suivi p√©dagogique. Elles sont stock√©es en France et prot√©g√©es conform√©ment au R√®glement G√©n√©ral sur la Protection des Donn√©es (RGPD).
                        </p>
                    </article>
                </div>
            </div>
        </section>

    </main>
    
    <!-- Pied de page (Footer) -->
    <footer class="bg-gray-900 mt-8 py-4 px-4 text-center text-xs text-gray-600 border-t border-gray-800">
        <p>&copy; 2025 PERMIS RECORD SAS. Tous droits r√©serv√©s.</p>
        <p class="mt-1">
            <!-- Les liens dans le footer pointent vers la section L√©gales -->
            <a href="#" onclick="showSection('legales'); return false;" class="hover:text-gold-text mx-2 text-gray-500 hover:text-yellow-500 transition duration-200">Mentions L√©gales</a> |
            <a href="#" onclick="showSection('legales'); return false;" class="hover:text-gold-text mx-2 text-gray-500 hover:text-yellow-500 transition duration-200">CGV</a> |
            <a href="#" onclick="showSection('legales'); return false;" class="hover:text-gold-text mx-2 text-gray-500 hover:text-yellow-500 transition duration-200">Confidentialit√©</a>
        </p>
    </footer>

    <!-- JavaScript pour la gestion des onglets, des formulaires et de Firebase -->
    <script type="module">
        // Importations Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, setPersistence, browserSessionPersistence } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        // Ajout des fonctions Firestore n√©cessaires pour l'√©criture
        import { getFirestore, addDoc, collection, serverTimestamp, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Variables globales pour Firebase et l'utilisateur
        let db;
        let auth;
        let userId = null;
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        let connectionErrorShown = false;
        
        // Chemin de la collection publique pour les r√©servations (accessible par l'admin)
        const RESERVATIONS_COLLECTION_PATH = `/artifacts/${appId}/public/data/reservations`;

        // Configuration des prix par type de le√ßon
        const LESSON_PRICES = {
            "initiale": { hours: 2, price: 100, label: "Le√ßon initiale (2h)" },
            "perfectionnement": { hours: 1, price: 50, label: "Perfectionnement (1h)" },
            "conduite_accompagnee": { hours: 2, price: 100, label: "Conduite Accompagn√©e (2h)" }
        };
        
        /**
         * Affiche un message d'erreur de connexion Firebase
         */
        function showFirebaseError() {
            if (!connectionErrorShown) {
                showMessage("Erreur Syst√®me", "Impossible de se connecter √† la base de donn√©es ou d'enregistrer les donn√©es. Veuillez v√©rifier les r√®gles de s√©curit√© Firebase.");
                connectionErrorShown = true;
            }
        }
        
        /**
         * Initialise Firebase et authentifie l'utilisateur.
         */
        async function initializeFirebase() {
            try {
                setLogLevel('debug');
                if (Object.keys(firebaseConfig).length === 0) {
                    throw new Error("Firebase configuration non trouv√©e.");
                }

                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                
                await setPersistence(auth, browserSessionPersistence);

                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }

                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        userId = user.uid;
                        console.log("Firebase Auth Ready. User ID:", userId);
                    } else {
                        userId = crypto.randomUUID(); 
                        console.warn("Signed in anonymously. Using generated ID:", userId);
                    }
                    // Connexion r√©ussie, r√©initialise le drapeau d'erreur.
                    connectionErrorShown = false; 

                }, (error) => {
                    console.error("Erreur onAuthStateChanged:", error);
                    showFirebaseError();
                });

            } catch (error) {
                console.error("Erreur lors de l'initialisation de Firebase:", error);
                    showFirebaseError();
            }
        }

        // Fonction pour afficher une section sp√©cifique et mettre √† jour le style des boutons
        window.showSection = (targetId) => {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('hidden');
            });
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('gold-text', 'bg-gray-700', 'border-b-4', 'gold-border');
                button.classList.add('text-gray-400');
            });

            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }

            const activeTab = document.querySelector(`.tab-button[data-target="${targetId}"]`);
            if (activeTab) {
                activeTab.classList.remove('text-gray-400');
                activeTab.classList.add('gold-text', 'bg-gray-700', 'border-b-4', 'gold-border');
            }
        }

        // Fonction pour afficher le message modal (remplace alert/confirm)
        window.showMessage = (title, content) => {
            document.getElementById('message-title').textContent = title;
            document.getElementById('message-content').innerHTML = content;
            document.getElementById('message-box').classList.remove('hidden');
            document.getElementById('message-box').classList.add('flex');
        }

        // Fonction pour masquer le message modal
        window.hideMessage = () => {
            document.getElementById('message-box').classList.add('hidden');
            document.getElementById('message-box').classList.remove('flex');
        }

        /**
         * Mise √† jour de l'affichage du prix en fonction de la s√©lection.
         */
        window.updatePriceDisplay = () => {
            const selectElement = document.getElementById('lesson-type');
            const displayElement = document.getElementById('lesson-price-display');
            const buttonElement = document.getElementById('reserve-button');
            const selectedType = selectElement.value;
            
            if (selectedType && LESSON_PRICES[selectedType]) {
                const priceInfo = LESSON_PRICES[selectedType];
                displayElement.innerHTML = `Prix total √† payer : <span class="text-white text-3xl">${priceInfo.price} ‚Ç¨</span>`;
                
                // Active le bouton de paiement
                buttonElement.disabled = false;
                buttonElement.classList.remove('bg-gray-600', 'text-gray-300', 'cursor-not-allowed');
                buttonElement.classList.add('gold-bg', 'text-gray-900', 'hover:bg-yellow-400', 'shadow-md', 'hover:shadow-yellow-500/50');

            } else {
                displayElement.innerHTML = `S√©lectionnez une le√ßon pour voir le prix.`;
                
                // D√©sactive le bouton de paiement
                buttonElement.disabled = true;
                buttonElement.classList.add('bg-gray-600', 'text-gray-300', 'cursor-not-allowed');
                buttonElement.classList.remove('gold-bg', 'text-gray-900', 'hover:bg-yellow-400', 'shadow-md', 'hover:shadow-yellow-500/50');
            }
        }

        /**
         * Construit l'URL de paiement PayPal (√† adapter).
         * @param {number} price Le montant √† payer.
         * @param {string} item Le nom de l'article.
         * @returns {string} L'URL PayPal.
         */
        function buildPayPalLink(price, item) {
            // üö® REMPLACEZ 'votre-email-paypal-ici@example.com' par votre adresse email PayPal Business r√©elle.
            const businessEmail = 'votre-email-paypal-ici@example.com'; 
            const baseUrl = 'https://www.paypal.com/cgi-bin/webscr?';
            const params = new URLSearchParams({
                cmd: '_xclick',
                business: businessEmail,
                item_name: `Reservation Le√ßon: ${item}`,
                amount: price.toFixed(2), // 100.00
                currency_code: 'EUR',
                // Facultatif : URL de retour apr√®s paiement (exemple)
                // return: window.location.href 
            });
            return baseUrl + params.toString();
        }


        // Gestionnaire de soumission de formulaire
        window.handleFormSubmission = async (event, formType) => {
            event.preventDefault(); // Emp√™che l'envoi r√©el du formulaire

            if (formType === 'conduite') {
                if (!db || !userId) {
                    showFirebaseError();
                    return;
                }

                const email = document.getElementById('lesson-email').value;
                const selectElement = document.getElementById('lesson-type');
                const selectedType = selectElement.value;
                const date = document.getElementById('lesson-date').value;
                const time = document.getElementById('lesson-time').value;

                if (!selectedType || !date || !time || !email) {
                    showMessage("Erreur de R√©servation", "Veuillez remplir tous les champs (Email, Type de Le√ßon, Date et Heure).");
                    return;
                }
                
                const priceInfo = LESSON_PRICES[selectedType];
                const paypalLink = buildPayPalLink(priceInfo.price, priceInfo.label);
                
                // 1. Sauvegarder la r√©servation dans Firestore (statut 'En attente de paiement')
                try {
                    const newReservation = {
                        email: email,
                        type: priceInfo.label,
                        price: priceInfo.price,
                        date: date,
                        time: time,
                        status: 'En attente de paiement', // Statut pour indiquer que le paiement n'est pas encore confirm√©
                        reservedBy: userId,
                        createdAt: serverTimestamp() 
                    };

                    await addDoc(collection(db, RESERVATIONS_COLLECTION_PATH), newReservation);

                } catch (e) {
                    console.error("Erreur d'ajout de document de r√©servation : ", e);
                    showMessage("Erreur Syst√®me", `Impossible de sauvegarder votre demande de r√©servation (Erreur Firestore). Veuillez r√©essayer. ${e.message}`);
                    return; // Arr√™ter si la sauvegarde √©choue
                }

                // 2. Ouvrir le modal pour la redirection PayPal
                const content = `
                    <p class="mb-4 text-gray-300">
                        Votre demande de r√©servation a √©t√© enregistr√©e. Veuillez finaliser le paiement pour confirmer votre le√ßon.
                    </p>
                    <p class="mb-4">
                        Montant √† r√©gler : <strong>${priceInfo.price} ‚Ç¨</strong> pour votre le√ßon de <strong>${priceInfo.label}</strong>.
                    </p>
                    <a href="${paypalLink}" target="_blank" class="block w-full py-3 px-4 rounded-lg gold-bg text-gray-900 font-bold hover:bg-yellow-400 transition duration-200 text-center text-lg shadow-md" onclick="hideMessage(); event.target.textContent='Redirection en cours...'">
                        Continuer vers PayPal pour le Paiement
                    </a>
                `;

                showMessage("Finaliser le Paiement", content);

            } else if (formType === 'examen') {
                // Logique pour Examen (Simulation)
                const examType = document.getElementById('exam-type').value;
                const date1 = document.getElementById('exam-date-1').value;
                
                showMessage("Demande d'Examen Re√ßue (Simulation)", `Votre demande pour le permis ${examType} pour le <strong>${date1}</strong> a √©t√© enregistr√©e (Simulation).`);
                event.target.reset();

            } else if (formType === 'inscription') {
                // Logique pour Inscription (Simulation)
                showMessage("Pr√©-inscription R√©ussie (Simulation)", `F√©licitations ! Votre dossier a √©t√© soumis (Simulation). Veuillez consulter l'email que nous venons de vous envoyer pour la liste des documents √† fournir et la finalisation de votre inscription.`);
                event.target.reset();
            }
        }

        // Initialisation : afficher la section Accueil par d√©faut et initialiser Firebase
        document.addEventListener('DOMContentLoaded', () => {
            showSection('accueil-et-reservation'); 
            initializeFirebase();
            updatePriceDisplay(); // Initialise l'affichage du prix au chargement
        });
    </script>

</body>
</html>

